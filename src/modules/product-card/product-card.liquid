{%- assign is_vue_component = is_vue_component | default: false -%}
{%- assign custom_attrs = custom_attrs | default: '' -%}
{% assign class = class | default: false %}
{% assign title = title | default: false %}
{% assign link = link | default: false %}
{% assign price = price | default: false %}
{% assign quick_shop_form = quick_shop_form | default: false %}
{% capture class %}product-card{% if class %} {{- class -}}{% endif %}{% endcapture %}

{%- capture content -%}
    <div class="product-card__inner">
      <div class="product-card__header">
        <a v-if="isFeatured && product.video" :href="product.url" class="product-card__video-container">
          {%- render 'video', mod_class: 'product-card__video', mod_is_vue: true, mod_vue_attrs: ':src="product.video"' -%}
        </a>
        <div v-else class="product-card__image-container">
          <a :href="product.url" class="product-card__image-link">
            {%- render 'image', class: 'no-hover', vue_attrs: ':image-src="product.featured_image"' -%}
          </a>
        </div>
        {%- if quick_shop_form -%}
          <div class="product-card__form">
            {{- quick_shop_form -}}
          </div>
        {%- endif -%}
      </div>
      <div class="product-card__content">
        <h4 class="product-card__title">
          <a :href="product.url" class="b1 product-card__title-link">${ product.title }</a>
        </h4>
        <div class="b1 product-card__review">
          <a :href="product.url + '#review-drawer'" class="product-card__review-link">
            <div class="yotpo bottomLine" :data-product-id="product.id"></div>
            <div class="yotpo QABottomLine" :data-product-id="product.id"></div>
          </a>
        </div>
        <p class="h5 product-card__price">$${formatPrice(price)}</p>
        <p v-if="shouldShowMessage && addedToCartErrorMessage" class="b1 product-card__message">${addedToCartErrorMessage}</p>
      </div>
    </div>
{%- endcapture -%}

{%- if is_vue_component -%}
  <div class="{{- class -}}" is="product-card" inline-template {{ custom_attrs }}>
    <div v-if="product" class="{{- class -}}">
      {{ content }}
    </div>
  </div>
{%- elsif product -%}
  {%- capture product_json -%}
    {% render 'product-json', product: product %}
  {%- endcapture -%}

  <div class="{{- class -}}" data-module="product-card" {{ custom_attrs }}>
    <div is="product-card"
         :product="{{- product_json | escape }}"
         inline-template
    >
      {{ content }}
    </div>
  </div>
{%- endif -%}
